# QA ì²´í¬ë¦¬ìŠ¤íŠ¸

**Last Updated**: 2025-11-09
**Purpose**: ë°°í¬ ì „ í•„ìˆ˜ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

## ğŸš¨ Critical Path (ë°°í¬ ì „ í•„ìˆ˜)

### 1. ì‹ ê·œ ì°¸ê°€ì íšŒì›ê°€ì… ë° ì¸ì¦

- [ ] ì „í™”ë²ˆí˜¸ ì¸ì¦ìœ¼ë¡œ íšŒì›ê°€ì…
- [ ] ì ‘ê·¼ ì½”ë“œ ì…ë ¥ (3ê¸°)
- [ ] ì±„íŒ… í™”ë©´ ì§„ì… í™•ì¸
- [ ] í”„ë¡œí•„ ë¶ ì‘ì„±
- [ ] ë…ì„œ ì¸ì¦ Step 1: ì´ë¯¸ì§€ ì—…ë¡œë“œ
- [ ] ë…ì„œ ì¸ì¦ Step 2: ì±… ê²€ìƒ‰ ë° ê°ìƒí‰ ì‘ì„±
- [ ] ë…ì„œ ì¸ì¦ Step 3: Daily Question ë‹µë³€ ë° ì œì¶œ
- [ ] ì˜¤ëŠ˜ì˜ ì„œì¬ í™•ì¸ (ë¯¸ì¸ì¦ ìƒíƒœ)
- [ ] ë‹¤ìŒë‚ : í”„ë¡œí•„ë¶ ë„ì°© í™•ì¸ (ëœë¤ 2ê°œ)

### 2. ê¸°ì¡´ ì°¸ê°€ì ì¬ì°¸ì—¬ (1ê¸°â†’3ê¸°)

**Critical**: ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¶Œí•œ ì˜¤ë¥˜ ì¬ë°œ ë°©ì§€

- [ ] 1ê¸° ì°¸ê°€ìë¡œ ë¡œê·¸ì¸ (ì „í™”ë²ˆí˜¸ ì¸ì¦)
- [ ] 3ê¸° ì ‘ê·¼ ì½”ë“œ ì…ë ¥
- [ ] ë…ì„œ ì¸ì¦ Step 1: **ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„±ê³µ í™•ì¸** âš ï¸
- [ ] Step 2, 3 ì§„í–‰ ë° ì œì¶œ
- [ ] participationCode í™•ì¸: "cohort3-xxx" (1ê¸° ID ì•„ë‹˜)
- [ ] ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ê²½ë¡œ: `reading_submissions/cohort3-xxx/`
- [ ] ì´ë¯¸ì§€ ì •ìƒ í‘œì‹œ í™•ì¸

**ì ê²€ í•­ëª©**:
```bash
# UID ì¤‘ë³µ í™•ì¸
npm run cleanup:duplicate-uid

# ì¤‘ë³µ ë°œê²¬ ì‹œ ì •ë¦¬
npm run cleanup:duplicate-uid:apply
```

### 3. í”„ë¡œí•„ë¶ ë§¤ì¹­ ì‹œìŠ¤í…œ

- [ ] 1ì¼ì°¨: ì¸ì¦ í›„ "ì²« ì¸ì¦ ì™„ë£Œ" í™”ë©´
- [ ] 2ì¼ì°¨ 14:00: í‘¸ì‹œ ì•Œë¦¼ ìˆ˜ì‹ 
- [ ] ì˜¤ëŠ˜ì˜ ì„œì¬: ëœë¤ 2ê°œ í”„ë¡œí•„ë¶ í‘œì‹œ (ë¯¸ì¸ì¦)
- [ ] ì˜¤ëŠ˜ ì¸ì¦ í›„: ì „ì²´ í”„ë¡œí•„ë¶ ì—´ëŒ (ì„±ë³„ ê· í˜•)
- [ ] í”„ë¡œí•„ë¶ ê°œìˆ˜: 2 Ã— (ëˆ„ì ì¸ì¦ + 1) ê³µì‹ í™•ì¸
- [ ] ìµœê·¼ 3ì¼ ì¤‘ë³µ ë°©ì§€ ë™ì‘ í™•ì¸

### 4. ê´€ë¦¬ì ê¸°ëŠ¥

- [ ] ê³µì§€ì‚¬í•­ ì‘ì„± ë° ë°œí–‰
- [ ] ì„ì‹œì €ì¥ â†’ ë°œí–‰ ì‹œ í‘¸ì‹œ ì•Œë¦¼
- [ ] DM ìˆ˜ì‹  ë° ë‹µì¥
- [ ] ì°¸ê°€ì ëª©ë¡ í™•ì¸

## ğŸ“‹ Regression Tests (íšŒê·€ ë°©ì§€)

### ë…ì„œ ì¸ì¦ í”Œë¡œìš°

- [ ] Step2 ì„ì‹œì €ì¥ ì‹¤íŒ¨í•´ë„ Step3 ì§„ì… ê°€ëŠ¥
- [ ] ì´ë¯¸ì§€ ì—†ì´ë„ ì œì¶œ ê°€ëŠ¥
- [ ] ì±… ê²€ìƒ‰ ê²°ê³¼ ì •ìƒ í‘œì‹œ
- [ ] ê°ìƒí‰ 500ì ì œí•œ ë™ì‘

### í”„ë¡œí•„ë¶ ì ‘ê·¼ ì œì–´

- [ ] ëˆ„ì ì¸ì¦ 0íšŒ: 2ê°œ í”„ë¡œí•„ë¶
- [ ] ëˆ„ì ì¸ì¦ 5íšŒ: 12ê°œ í”„ë¡œí•„ë¶
- [ ] ë¯¸ì¸ì¦ ì‹œ: 2ê°œë§Œ ì—´ëŒ (ë‚¨1+ì—¬1)
- [ ] ì¸ì¦ ì‹œ: ì „ì²´ ì—´ëŒ

### ê¸°ìˆ˜ ì „í™˜

- [ ] ì—¬ëŸ¬ ê¸°ìˆ˜ ì°¸ê°€ì: ê¸°ìˆ˜ ì „í™˜ í™”ë©´
- [ ] ê¸°ìˆ˜ë³„ ë°ì´í„° ë¶„ë¦¬ í™•ì¸
- [ ] participationCode ì •í™•ì„±

## ğŸ”§ ë°ì´í„° ë¬´ê²°ì„± ì²´í¬

### ë°°í¬ ì „ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
# 1. participationCode ì ê²€
npm run check:participation-code

# 2. UID ì¤‘ë³µ ì ê²€ ë° ì •ë¦¬
npm run cleanup:duplicate-uid
npm run cleanup:duplicate-uid:apply  # ì¤‘ë³µ ë°œê²¬ ì‹œ

# 3. ë°ì´í„°ë² ì´ìŠ¤ í†µê³„
npm run stats
```

### ì˜ˆìƒ ê²°ê³¼

- âœ… participationCode: ëª¨ë“  ì œì¶œë¬¼ì— ì¡´ì¬
- âœ… UID ì¤‘ë³µ: 0ê°œ
- âœ… í™œì„± cohort: isActive = true

## ğŸ› ì•Œë ¤ì§„ ì´ìŠˆ ë° í•´ê²°ì±…

### 1. 1ê¸°â†’3ê¸° ì°¸ê°€ì ì´ë¯¸ì§€ ì—…ë¡œë“œ ì˜¤ë¥˜

**ì¦ìƒ**: "ê¶Œí•œ ì—†ìŒ" ì—ëŸ¬

**ì›ì¸**:
- UID ì¤‘ë³µ (1ê¸° ë¬¸ì„œ + 3ê¸° ë¬¸ì„œ)
- Storage/Firestore Rules ê²½ë¡œ ë¶ˆì¼ì¹˜

**í•´ê²°**:
- Firestore Rules ëŠìŠ¨í™” (firebaseUid null í—ˆìš©)
- Storage Rules ì™€ì¼ë“œì¹´ë“œ ì ìš©
- getParticipantByFirebaseUidì— ìë™ ì •ë¦¬ ë¡œì§ ì¶”ê°€

**ì¬ë°œ ë°©ì§€**:
- ë°°í¬ ì „ `npm run cleanup:duplicate-uid` ì‹¤í–‰
- ë¡œê·¸ì¸ ì‹œ ìë™ìœ¼ë¡œ UID ì¤‘ë³µ ì •ë¦¬

### 2. Firestore 'in' ì¿¼ë¦¬ 10ê°œ ì œí•œ

**ì¦ìƒ**: ëˆ„ì ì¸ì¦ 5íšŒ ì´ìƒì—ì„œ FirebaseError

**ì›ì¸**: allFeaturedIds.length > 10

**í•´ê²°**: ì²­í‚¹ ì²˜ë¦¬ (10ê°œì”© ë¶„í•  ì¡°íšŒ)

### 3. ëˆ„ì ì¸ì¦ ì „ì²´ ê¸°ìˆ˜ ì¹´ìš´íŠ¸

**ì¦ìƒ**: 1ê¸° ì°¸ê°€ìê°€ 3ê¸°ì—ì„œ ê³¼ë„í•œ í”„ë¡œí•„ë¶ ìˆ˜ì‹ 

**ì›ì¸**: participationCode í•„í„° ëˆ„ë½

**í•´ê²°**:
- ë°±ì—”ë“œ: participationCode í•„í„° ì¶”ê°€
- í”„ë¡ íŠ¸: participationCode í•„í„° ì¶”ê°€
- Fallback: participationCode || participant.id

## ğŸ“± ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### Scenario A: ì™„ì „ ì‹ ê·œ ìœ ì €
```
1. ì „í™”ë²ˆí˜¸ ì¸ì¦ (ìƒˆ ë²ˆí˜¸)
2. 3ê¸° ì ‘ê·¼ ì½”ë“œ ì…ë ¥
3. ë…ì„œ ì¸ì¦ ì™„ë£Œ
â†’ ì˜ˆìƒ: ì •ìƒ ì‘ë™
```

### Scenario B: 1ê¸° ì°¸ê°€ì (3ê¸° ì¬ì°¸ì—¬)
```
1. ì „í™”ë²ˆí˜¸ ì¸ì¦ (1ê¸° ë•Œ ì‚¬ìš©í•œ ë²ˆí˜¸)
2. 3ê¸° ì ‘ê·¼ ì½”ë“œ ì…ë ¥
3. ë…ì„œ ì¸ì¦ Step 1: ì´ë¯¸ì§€ ì—…ë¡œë“œ âš ï¸
â†’ ì˜ˆìƒ: ì •ìƒ ì—…ë¡œë“œ (ê¶Œí•œ ì˜¤ë¥˜ ì—†ìŒ)
â†’ ê²½ë¡œ: reading_submissions/cohort3-xxx/
```

### Scenario C: ê´€ë¦¬ì
```
1. ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
2. ê³µì§€ì‚¬í•­ ì‘ì„± ë° ë°œí–‰
3. í‘¸ì‹œ ì•Œë¦¼ ìˆ˜ì‹  í™•ì¸
â†’ ì˜ˆìƒ: ì „ì²´ ì°¸ê°€ìì—ê²Œ ì•Œë¦¼
```

## ğŸ” ë°°í¬ í›„ ëª¨ë‹ˆí„°ë§

### Firebase Console í™•ì¸

1. **Firestore (Default DB)**:
   - reading_submissions ìƒì„± í™•ì¸
   - participationCode ì¼ê´€ì„±

2. **Storage**:
   - reading_submissions/ ê²½ë¡œ í™•ì¸
   - ì´ë¯¸ì§€ ì •ìƒ ì—…ë¡œë“œ

3. **Functions Logs**:
   - scheduledRandomMatching: ë§¤ì¼ 14:00 ì‹¤í–‰
   - ë§¤ì¹­ ì„±ê³µ ë¡œê·¸
   - í‘¸ì‹œ ì•Œë¦¼ ì „ì†¡ ë¡œê·¸

### ì˜¤ë¥˜ ë¡œê·¸ ëª¨ë‹ˆí„°ë§

```bash
# Functions ë¡œê·¸
firebase functions:log --only scheduledRandomMatching

# ì•± ë¡œê·¸ (ë¸Œë¼ìš°ì € Console)
- [UID Duplicate] ë¡œê·¸ í™•ì¸
- [UID Cleanup] ë¡œê·¸ í™•ì¸
```

## âœ… ë°°í¬ ì „ ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `npm run check:participation-code` ì‹¤í–‰
- [ ] `npm run cleanup:duplicate-uid` ì‹¤í–‰ (ì¤‘ë³µ 0ê°œ í™•ì¸)
- [ ] `npm run build` ì„±ê³µ
- [ ] `npm run lint` í†µê³¼
- [ ] Firebase Rules ë°°í¬ (`firebase deploy --only firestore,storage`)
- [ ] ìˆ˜ë™ í…ŒìŠ¤íŠ¸: Scenario B (1ê¸°â†’3ê¸° ì°¸ê°€ì) âš ï¸

---

**ì¤‘ìš”**: Scenario B í…ŒìŠ¤íŠ¸ëŠ” ë°°í¬ í›„ **ë°˜ë“œì‹œ** í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤!
